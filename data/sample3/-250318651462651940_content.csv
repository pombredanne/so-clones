"Content"
"    Sub SplitWorkbook()&#xD;&#xA;    Dim FileExtStr As String&#xD;&#xA;    Dim FileFormatNum As Long&#xD;&#xA;    Dim xWs As Worksheet&#xD;&#xA;    Dim xWb As Workbook&#xD;&#xA;    Dim FolderName As String&#xD;&#xA;    Application.ScreenUpdating = False&#xD;&#xA;    Set xWb = Application.ThisWorkbook&#xD;&#xA;    DateString = Format(Now, """"""""yyyy-mm-dd hh-mm-ss"""""""")&#xD;&#xA;    FolderName = xWb.Path & """"""""\"""""""" & xWb.Name & """""""" """""""" & DateString&#xD;&#xA;    MkDir FolderName&#xD;&#xA;    For Each xWs In xWb.Worksheets&#xD;&#xA;        xWs.Copy&#xD;&#xA;        If Val(Application.Version) < 12 Then&#xD;&#xA;            FileExtStr = """""""".xls"""""""": FileFormatNum = -4143&#xD;&#xA;        Else&#xD;&#xA;            Select Case xWb.FileFormat&#xD;&#xA;                Case 51:&#xD;&#xA;                    FileExtStr = """""""".xlsx"""""""": FileFormatNum = 51&#xD;&#xA;                Case 52:&#xD;&#xA;                    If Application.ActiveWorkbook.HasVBProject Then&#xD;&#xA;                        FileExtStr = """""""".xlsm"""""""": FileFormatNum = 52&#xD;&#xA;                    Else&#xD;&#xA;                        FileExtStr = """""""".xlsx"""""""": FileFormatNum = 51&#xD;&#xA;                    End If&#xD;&#xA;                Case 56:&#xD;&#xA;                    FileExtStr = """""""".xls"""""""": FileFormatNum = 56&#xD;&#xA;                Case Else:&#xD;&#xA;                    FileExtStr = """""""".xlsb"""""""": FileFormatNum = 50&#xD;&#xA;            End Select&#xD;&#xA;        End If&#xD;&#xA;        xFile = FolderName & """"""""\"""""""" & Application.ActiveWorkbook.Sheets(1).Name & FileExtStr&#xD;&#xA;        Application.ActiveWorkbook.SaveAs xFile, FileFormat:=FileFormatNum&#xD;&#xA;        Application.ActiveWorkbook.Close False&#xD;&#xA;    Next&#xD;&#xA;    MsgBox """"""""You can find the files in """""""" & FolderName&#xD;&#xA;    Application.ScreenUpdating = True&#xD;&#xA;    End Sub"
