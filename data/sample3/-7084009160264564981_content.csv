"Content"
"    CREATE PROC SearchAllTables&#xD;&#xA;    (&#xD;&#xA;        @SearchStr nvarchar(100)&#xD;&#xA;    )&#xD;&#xA;    AS&#xD;&#xA;    BEGIN&#xD;&#xA;    &#xD;&#xA;    -- Copyright Â© 2002 Narayana Vyas Kondreddi. All rights reserved.&#xD;&#xA;    -- Purpose: To search all columns of all tables for a given search string&#xD;&#xA;    -- Written by: Narayana Vyas Kondreddi&#xD;&#xA;    -- Site: http://vyaskn.tripod.com&#xD;&#xA;    -- Tested on: SQL Server 7.0 and SQL Server 2000&#xD;&#xA;    -- Date modified: 28th July 2002 22:50 GMT&#xD;&#xA;    &#xD;&#xA;    DECLARE @Results TABLE(ColumnName nvarchar(370), ColumnValue nvarchar(3630))&#xD;&#xA;    &#xD;&#xA;    SET NOCOUNT ON&#xD;&#xA;    &#xD;&#xA;    DECLARE @TableName nvarchar(256), @ColumnName nvarchar(128), @SearchStr2 nvarchar(110)&#xD;&#xA;    SET  @TableName = ''&#xD;&#xA;    SET @SearchStr2 = QUOTENAME('%' + @SearchStr + '%','''')&#xD;&#xA;    &#xD;&#xA;    WHILE @TableName IS NOT NULL&#xD;&#xA;    BEGIN&#xD;&#xA;        SET @ColumnName = ''&#xD;&#xA;        SET @TableName = &#xD;&#xA;        (&#xD;&#xA;            SELECT MIN(QUOTENAME(TABLE_SCHEMA) + '.' + QUOTENAME(TABLE_NAME))&#xD;&#xA;            FROM    INFORMATION_SCHEMA.TABLES&#xD;&#xA;            WHERE       TABLE_TYPE = 'BASE TABLE'&#xD;&#xA;                AND QUOTENAME(TABLE_SCHEMA) + '.' + QUOTENAME(TABLE_NAME) > @TableName&#xD;&#xA;                AND OBJECTPROPERTY(&#xD;&#xA;                        OBJECT_ID(&#xD;&#xA;                            QUOTENAME(TABLE_SCHEMA) + '.' + QUOTENAME(TABLE_NAME)&#xD;&#xA;                             ), 'IsMSShipped'&#xD;&#xA;                               ) = 0&#xD;&#xA;        )&#xD;&#xA;    &#xD;&#xA;        WHILE (@TableName IS NOT NULL) AND (@ColumnName IS NOT NULL)&#xD;&#xA;        BEGIN&#xD;&#xA;            SET @ColumnName =&#xD;&#xA;            (&#xD;&#xA;                SELECT MIN(QUOTENAME(COLUMN_NAME))&#xD;&#xA;                FROM    INFORMATION_SCHEMA.COLUMNS&#xD;&#xA;                WHERE       TABLE_SCHEMA    = PARSENAME(@TableName, 2)&#xD;&#xA;                    AND TABLE_NAME  = PARSENAME(@TableName, 1)&#xD;&#xA;                    AND DATA_TYPE IN ('char', 'varchar', 'nchar', 'nvarchar')&#xD;&#xA;                    AND QUOTENAME(COLUMN_NAME) > @ColumnName&#xD;&#xA;            )&#xD;&#xA;    &#xD;&#xA;            IF @ColumnName IS NOT NULL&#xD;&#xA;            BEGIN&#xD;&#xA;                INSERT INTO @Results&#xD;&#xA;                EXEC&#xD;&#xA;                (&#xD;&#xA;                    'SELECT ''' + @TableName + '.' + @ColumnName + ''', LEFT(' + @ColumnName + ', 3630) &#xD;&#xA;                    FROM ' + @TableName + ' (NOLOCK) ' +&#xD;&#xA;                    ' WHERE ' + @ColumnName + ' LIKE ' + @SearchStr2&#xD;&#xA;                )&#xD;&#xA;            END&#xD;&#xA;        END &#xD;&#xA;    END&#xD;&#xA;    &#xD;&#xA;    SELECT ColumnName, ColumnValue FROM @Results&#xD;&#xA;    END"
